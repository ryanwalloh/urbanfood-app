{% extends 'components/rider/dashboard_base.html' %}

{% load static %}

{% if not user.is_authenticated %}
    <script>window.location.href = "/";</script>
{% endif %}

{% block content %}

<!-- Navigation Page Container -->
<div class="navigation-container">
    <!-- Full Width Map -->
    <div id="map" class="map-container"></div>
    
    <!-- Back Button (Top Left) -->
    <button class="back-button" onclick="goBack()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>
    
    <!-- Live Tracking Indicator (Top Right) -->
    <div class="tracking-indicator" id="trackingIndicator">
        <div class="tracking-dot"></div>
        <span class="tracking-text">Live Tracking</span>
    </div>
    
    <!-- Zoom Controls (Top Right Below Tracking) -->
    <div class="zoom-controls">
        <button class="zoom-button zoom-in" onclick="zoomIn()" title="Zoom In">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button class="zoom-button zoom-out" onclick="zoomOut()" title="Zoom Out">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>
    
    <!-- Traffic Status Container -->
    <div class="traffic-status-container" id="trafficStatusContainer">
        <div class="traffic-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        <div class="traffic-content">
            <div class="traffic-title">Traffic Status</div>
            <div class="traffic-level" id="trafficLevel">Loading...</div>
        </div>
        <div class="traffic-indicator" id="trafficIndicator">
            <div class="traffic-dot"></div>
        </div>
    </div>
    
    <!-- Bottom Container -->
    <div class="bottom-navigation-container">
        <div class="download-message">
            <div class="download-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="download-content">
                <h3>Get the Full Experience</h3>
                <p>Download our mobile app to access rider assignments, real-time order tracking, and exclusive rider features.</p>
                <div class="download-buttons">
                    <img class="google-play-download" src="{% static 'rider/images/googleplay.png' %}" alt="Download on Google Play">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Google Maps Script -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCCuDLJMhB-23kQiXYpXwi-yYGvKz7OgSQ&libraries=geometry"></script>

<script>
    let map;
    let userMarker;
    let watchId;
    let isTracking = false;
    let currentLocation = null;

    // Custom map styles
    const mapStyles = [
        {
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#1d2c4d"
                }
            ]
        },
        {
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#8ec3b9"
                }
            ]
        },
        {
            "elementType": "labels.text.stroke",
            "stylers": [
                {
                    "color": "#1a3646"
                }
            ]
        },
        {
            "featureType": "administrative.country",
            "elementType": "geometry.stroke",
            "stylers": [
                {
                    "color": "#4b6878"
                }
            ]
        },
        {
            "featureType": "administrative.land_parcel",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "administrative.land_parcel",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#64779e"
                }
            ]
        },
        {
            "featureType": "administrative.neighborhood",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "administrative.province",
            "elementType": "geometry.stroke",
            "stylers": [
                {
                    "color": "#4b6878"
                }
            ]
        },
        {
            "featureType": "landscape.man_made",
            "elementType": "geometry.stroke",
            "stylers": [
                {
                    "color": "#334e87"
                }
            ]
        },
        {
            "featureType": "landscape.natural",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#023e58"
                }
            ]
        },
        {
            "featureType": "poi",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#283d6a"
                }
            ]
        },
        {
            "featureType": "poi",
            "elementType": "labels.text",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "poi",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#6f9ba5"
                }
            ]
        },
        {
            "featureType": "poi",
            "elementType": "labels.text.stroke",
            "stylers": [
                {
                    "color": "#1d2c4d"
                }
            ]
        },
        {
            "featureType": "poi.business",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "poi.park",
            "elementType": "geometry.fill",
            "stylers": [
                {
                    "color": "#023e58"
                }
            ]
        },
        {
            "featureType": "poi.park",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#3C7680"
                }
            ]
        },
        {
            "featureType": "road",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#304a7d"
                }
            ]
        },
        {
            "featureType": "road",
            "elementType": "labels",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "road",
            "elementType": "labels.icon",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "road",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#98a5be"
                }
            ]
        },
        {
            "featureType": "road",
            "elementType": "labels.text.stroke",
            "stylers": [
                {
                    "color": "#1d2c4d"
                }
            ]
        },
        {
            "featureType": "road.highway",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#2c6675"
                }
            ]
        },
        {
            "featureType": "road.highway",
            "elementType": "geometry.stroke",
            "stylers": [
                {
                    "color": "#255763"
                }
            ]
        },
        {
            "featureType": "road.highway",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#b0d5ce"
                }
            ]
        },
        {
            "featureType": "road.highway",
            "elementType": "labels.text.stroke",
            "stylers": [
                {
                    "color": "#023e58"
                }
            ]
        },
        {
            "featureType": "transit",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "transit",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#98a5be"
                }
            ]
        },
        {
            "featureType": "transit",
            "elementType": "labels.text.stroke",
            "stylers": [
                {
                    "color": "#1d2c4d"
                }
            ]
        },
        {
            "featureType": "transit.line",
            "elementType": "geometry.fill",
            "stylers": [
                {
                    "color": "#283d6a"
                }
            ]
        },
        {
            "featureType": "transit.station",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#3a4762"
                }
            ]
        },
        {
            "featureType": "water",
            "elementType": "geometry",
            "stylers": [
                {
                    "color": "#0e1626"
                }
            ]
        },
        {
            "featureType": "water",
            "elementType": "labels.text",
            "stylers": [
                {
                    "visibility": "off"
                }
            ]
        },
        {
            "featureType": "water",
            "elementType": "labels.text.fill",
            "stylers": [
                {
                    "color": "#4e6d70"
                }
            ]
        }
    ];

    // Initialize map
    function initMap() {
        // Default to Iligan City coordinates
        const iliganCity = { lat: 8.2474, lng: 124.2452 };
        
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 16,
            center: iliganCity,
            styles: mapStyles,
            mapTypeControl: false,
            streetViewControl: false,
            fullscreenControl: false,
            zoomControl: true,
            zoomControlOptions: {
                position: google.maps.ControlPosition.RIGHT_BOTTOM
            }
        });

        // Start live location tracking
        startLiveTracking();
    }

    // Start live location tracking
    function startLiveTracking() {
        if (navigator.geolocation) {
            console.log('ðŸ”„ Starting live location tracking...');
            
            // Get initial position
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    updateLocation(position);
                    startWatchingLocation();
                },
                function(error) {
                    console.log('âŒ Initial location error:', error.message);
                    showLocationError();
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        } else {
            console.log('âŒ Geolocation not supported');
            showLocationError();
        }
    }

    // Start watching location changes
    function startWatchingLocation() {
        if (navigator.geolocation) {
            watchId = navigator.geolocation.watchPosition(
                function(position) {
                    updateLocation(position);
                },
                function(error) {
                    console.log('âŒ Watch location error:', error.message);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 15000,
                    maximumAge: 5000
                }
            );
            isTracking = true;
            console.log('âœ… Live tracking started');
            
            // Show tracking indicator
            const trackingIndicator = document.getElementById('trackingIndicator');
            if (trackingIndicator) {
                trackingIndicator.classList.add('active');
            }
        }
    }

    // Update location on map
    function updateLocation(position) {
        const userLocation = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
        };
        
        currentLocation = userLocation;
        
        // Center map on user location
        map.setCenter(userLocation);
        
        // Update or create user marker
        if (userMarker) {
            userMarker.setPosition(userLocation);
        } else {
            userMarker = new google.maps.Marker({
                position: userLocation,
                map: map,
                title: 'Your Live Location',
                icon: {
                    url: '{% static "rider/images/ridermarker.png" %}',
                    scaledSize: new google.maps.Size(48, 48),
                    anchor: new google.maps.Point(16, 16)
                },
                animation: google.maps.Animation.DROP
            });
        }
        
        // Add accuracy circle
        const accuracyCircle = new google.maps.Circle({
            strokeColor: '#F43332',
            strokeOpacity: 0.3,
            strokeWeight: 2,
            fillColor: '#F43332',
            fillOpacity: 0.1,
            map: map,
            center: userLocation,
            radius: position.coords.accuracy
        });
        
        // Remove previous accuracy circle after 5 seconds
        setTimeout(() => {
            accuracyCircle.setMap(null);
        }, 5000);
        
        console.log('ðŸ“ Location updated:', userLocation, 'Accuracy:', position.coords.accuracy + 'm');
    }

    // Stop live tracking
    function stopLiveTracking() {
        if (watchId) {
            navigator.geolocation.clearWatch(watchId);
            watchId = null;
            isTracking = false;
            console.log('â¹ï¸ Live tracking stopped');
            
            // Hide tracking indicator
            const trackingIndicator = document.getElementById('trackingIndicator');
            if (trackingIndicator) {
                trackingIndicator.classList.remove('active');
            }
        }
    }

    // Show location error and fallback
    function showLocationError() {
        // Add a marker at Iligan City as fallback
        const iliganCity = { lat: 8.2474, lng: 124.2452 };
        
        userMarker = new google.maps.Marker({
            position: iliganCity,
            map: map,
            title: 'Iligan City (Location not available)',
            icon: {
                url: '{% static "rider/images/ridermarker.png" %}',
                scaledSize: new google.maps.Size(48, 48),
                anchor: new google.maps.Point(16, 16)
            }
        });
    }

    // Go back to dashboard
    function goBack() {
        // Stop live tracking before leaving
        stopLiveTracking();
        window.location.href = '/rider/dashboard/';
    }

    // Zoom controls
    function zoomIn() {
        if (map && currentLocation) {
            const currentZoom = map.getZoom();
            const newZoom = Math.min(currentZoom + 1, 20); // Max zoom level 20
            
            map.setZoom(newZoom);
            map.setCenter(currentLocation);
            
            console.log('ðŸ” Zoomed in to level:', newZoom);
        } else if (map) {
            // Fallback to Iligan City if no current location
            const iliganCity = { lat: 8.2474, lng: 124.2452 };
            const currentZoom = map.getZoom();
            const newZoom = Math.min(currentZoom + 1, 20);
            
            map.setZoom(newZoom);
            map.setCenter(iliganCity);
            
            console.log('ðŸ” Zoomed in to level:', newZoom, '(Iligan City)');
        }
    }

    function zoomOut() {
        if (map && currentLocation) {
            const currentZoom = map.getZoom();
            const newZoom = Math.max(currentZoom - 1, 1); // Min zoom level 1
            
            map.setZoom(newZoom);
            map.setCenter(currentLocation);
            
            console.log('ðŸ” Zoomed out to level:', newZoom);
        } else if (map) {
            // Fallback to Iligan City if no current location
            const iliganCity = { lat: 8.2474, lng: 124.2452 };
            const currentZoom = map.getZoom();
            const newZoom = Math.max(currentZoom - 1, 1);
            
            map.setZoom(newZoom);
            map.setCenter(iliganCity);
            
            console.log('ðŸ” Zoomed out to level:', newZoom, '(Iligan City)');
        }
    }

    // Traffic API functions
    async function fetchTrafficData() {
        try {
            console.log('ðŸš¦ Fetching traffic data for Iligan City...');
            
            // OpenRouteService Traffic API endpoint
            const latitude = 8.2474;
            const longitude = 124.2452;
            
            // Get traffic data using OpenRouteService (free tier)
            const response = await fetch(`https://api.openrouteservice.org/v2/directions/driving-car?api_key=5b3ce3597851110001cf6248b4c7e8b7a6f44b999d8e4c8b8b4c7e8b7a6f44b99&start=${longitude},${latitude}&end=${longitude},${latitude}&radiuses=5000`);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            
            // Analyze traffic conditions (simplified for demo)
            const trafficLevel = analyzeTrafficConditions(data);
            updateTrafficDisplay(trafficLevel);
            
        } catch (error) {
            console.log('âŒ Traffic API error:', error.message);
            
            // Fallback to simulated traffic data
            const simulatedTraffic = getSimulatedTrafficData();
            updateTrafficDisplay(simulatedTraffic);
        }
    }

    function analyzeTrafficConditions(data) {
        // Simplified traffic analysis based on route data
        // In a real implementation, you would analyze the route segments
        
        const currentHour = new Date().getHours();
        let trafficLevel;
        
        // Simulate traffic based on time of day
        if (currentHour >= 7 && currentHour <= 9) {
            // Morning rush hour
            trafficLevel = {
                level: 'Heavy',
                color: 'red',
                description: 'Morning rush hour traffic'
            };
        } else if (currentHour >= 17 && currentHour <= 19) {
            // Evening rush hour
            trafficLevel = {
                level: 'Heavy',
                color: 'red',
                description: 'Evening rush hour traffic'
            };
        } else if (currentHour >= 12 && currentHour <= 14) {
            // Lunch time
            trafficLevel = {
                level: 'Moderate',
                color: 'yellow',
                description: 'Lunch time traffic'
            };
        } else {
            // Off-peak hours
            trafficLevel = {
                level: 'Light',
                color: 'green',
                description: 'Light traffic conditions'
            };
        }
        
        return trafficLevel;
    }

    function getSimulatedTrafficData() {
        const currentHour = new Date().getHours();
        
        if (currentHour >= 7 && currentHour <= 9 || currentHour >= 17 && currentHour <= 19) {
            return {
                level: 'Heavy Traffic',
                color: 'red',
                description: 'Rush hour - expect delays'
            };
        } else if (currentHour >= 12 && currentHour <= 14) {
            return {
                level: 'Moderate Traffic',
                color: 'yellow',
                description: 'Busy lunch period'
            };
        } else {
            return {
                level: 'Light Traffic',
                color: 'green',
                description: 'Good driving conditions'
            };
        }
    }

    function updateTrafficDisplay(trafficData) {
        const trafficLevel = document.getElementById('trafficLevel');
        const trafficIndicator = document.getElementById('trafficIndicator');
        const trafficContainer = document.getElementById('trafficStatusContainer');
        const trafficDot = trafficIndicator.querySelector('.traffic-dot');
        
        if (trafficLevel && trafficIndicator && trafficContainer && trafficDot) {
            // Update traffic level text
            trafficLevel.textContent = trafficData.level;
            
            // Update traffic indicator color
            trafficDot.className = `traffic-dot ${trafficData.color}`;
            
            // Show traffic container with animation
            trafficContainer.classList.add('active');
            
            console.log('ðŸš¦ Traffic updated:', trafficData);
        }
    }

    // Clean up when page is unloaded
    window.addEventListener('beforeunload', function() {
        stopLiveTracking();
    });

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
        initMap();
        
        // Fetch traffic data after a short delay
        setTimeout(() => {
            fetchTrafficData();
        }, 2000);
        
        // Update traffic data every 5 minutes
        setInterval(fetchTrafficData, 300000);
    });
</script>

<style>
    /* Navigation Page Styles */
    .navigation-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
    }

    .map-container {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
    }

    /* Back Button */
    .back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 1000;
        background-color: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
    }

    .back-button:hover {
        background-color: rgba(255, 255, 255, 1);
        transform: scale(1.05);
    }

    .back-button svg {
        color: #333;
        width: 20px;
        height: 20px;
    }

    /* Live Tracking Indicator */
    .tracking-indicator {
        position: absolute;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background-color: rgba(0, 0, 0, 0.8);
        color: #FFFFFF;
        padding: 8px 16px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 500;
        opacity: 0;
        transform: translateY(-10px);
        transition: all 0.3s ease;
    }

    .tracking-indicator.active {
        opacity: 1;
        transform: translateY(0);
    }

    .tracking-dot {
        width: 8px;
        height: 8px;
        background-color: #00FF00;
        border-radius: 50%;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% {
            box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7);
        }
        70% {
            box-shadow: 0 0 0 10px rgba(0, 255, 0, 0);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(0, 255, 0, 0);
        }
    }

    /* Zoom Controls */
    .zoom-controls {
        position: absolute;
        top: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }
    .zoom-button {
        background-color: rgba(223, 35, 35, 0.7);
        border: none;
        border-radius: 4px;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
        color: #FFFFFF;
    }

    .zoom-button:hover {
        background-color: rgb(216, 91, 91);
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .zoom-button:active {
        transform: scale(0.95);
    }

    .zoom-button svg {
        color: #f7f7f7;
        width: 46px;
        height: 46px;
    }

    .zoom-in {
        border-radius: 4px 4px 0 0;
    }

    .zoom-out {
        border-radius: 0 0 4px 4px;
    }

    /* Traffic Status Container */
    .traffic-status-container {
        position: absolute;
        bottom: 120px;
        left: 20px;
        right: 20px;
        z-index: 1000;
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
        padding: 12px 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 12px;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
    }

    .traffic-status-container.active {
        opacity: 1;
        transform: translateY(0);
    }

    .traffic-icon {
        flex-shrink: 0;
        color: #666;
    }

    .traffic-content {
        flex: 1;
        min-width: 0;
    }

    .traffic-title {
        font-size: 12px;
        font-weight: 600;
        color: #333;
        margin-bottom: 2px;
    }

    .traffic-level {
        font-size: 14px;
        font-weight: 500;
        color: #555;
    }

    .traffic-indicator {
        flex-shrink: 0;
    }

    .traffic-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: #FFA500;
        animation: trafficPulse 2s infinite;
    }

    .traffic-dot.green {
        background-color: #00C851;
    }

    .traffic-dot.yellow {
        background-color: #FFA500;
    }

    .traffic-dot.red {
        background-color: #FF4444;
    }

    @keyframes trafficPulse {
        0% {
            box-shadow: 0 0 0 0 rgba(255, 165, 0, 0.7);
        }
        70% {
            box-shadow: 0 0 0 8px rgba(255, 165, 0, 0);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(255, 165, 0, 0);
        }
    }

    /* Bottom Container */
    .bottom-navigation-container {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        padding: 20px;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    }

    .download-message {
        background-color: #FFFFFF;
        border-radius: 20px;
        padding: 24px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 20px;
        max-width: 500px;
        margin: 0 auto;
    }

    .download-icon {
        flex-shrink: 0;
        color: #F43332;
    }

    .download-content h3 {
        font-size: 18px;
        font-weight: 800;
        color: #333;
        margin: 0 0 8px 0;
    }

    .download-content p {
        font-size: 14px;
        font-weight: 300;
        color: #666;
        margin: 0 0 16px 0;
        line-height: 1.4;
    }

    .download-buttons {
        display: flex;
        gap: 12px;
    }

    .google-play-download {
        height: 40px;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .google-play-download:hover {
        transform: scale(1.05);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .back-button {
            top: 15px;
            left: 15px;
            width: 44px;
            height: 44px;
        }

        .back-button svg {
            width: 28px;
            height: 28px;
        }

        .tracking-indicator {
            top: 15px;
            right: 15px;
            padding: 6px 12px;
            font-size: 13px;
        }

        .zoom-controls {
            top: 480px;
            right: 15px;
        }

        .zoom-button {
            width: 46px;
            height: 46px;
        }

        .zoom-button svg {
            width: 24px;
            height: 24px;
        }

        .traffic-status-container {
            bottom: 110px;
            left: 15px;
            right: 15px;
            padding: 10px 14px;
        }

        .traffic-title {
            font-size: 11px;
        }

        .traffic-level {
            font-size: 13px;
        }

        .bottom-navigation-container {
            padding: 15px;
        }

        .download-message {
            padding: 20px;
            gap: 16px;
        }

        .download-content h3 {
            font-size: 16px;
        }

        .download-content p {
            font-size: 13px;
        }

        .google-play-download {
            height: 36px;
        }
    }

    @media (max-width: 480px) {
        .back-button {
            top: 10px;
            left: 10px;
            width: 40px;
            height: 40px;
        }

        .back-button svg {
            width: 26px;
            height: 26px;
        }

        .tracking-indicator {
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            font-size: 12px;
        }

        .zoom-controls {
            top: 60px;
            right: 10px;
        }

        .zoom-button {
            width: 32px;
            height: 32px;
        }

        .zoom-button svg {
            width: 12px;
            height: 12px;
        }

        .traffic-status-container {
            bottom: 100px;
            left: 10px;
            right: 10px;
            padding: 8px 12px;
        }

        .traffic-title {
            font-size: 10px;
        }

        .traffic-level {
            font-size: 12px;
        }

        .bottom-navigation-container {
            padding: 10px;
        }

        .download-message {
            padding: 16px;
            gap: 12px;
            flex-direction: column;
            text-align: center;
        }

        .download-content h3 {
            font-size: 15px;
        }

        .download-content p {
            font-size: 12px;
        }

        .google-play-download {
            height: 32px;
        }
    }
</style>

{% endblock %}
